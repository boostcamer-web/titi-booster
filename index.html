<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Titi Booster Flight</title>
    <style>
        body { margin: 0; padding: 0; background: #000; overflow: hidden; display: flex; flex-direction: column; min-height: 100vh; font-family: sans-serif; }
        .game-header { background: rgba(0, 0, 0, 0.9); padding: 10px; color: white; text-align: center; z-index: 10; border-bottom: 2px solid #ff9900; }
        #gameContainer { flex: 1; display: flex; justify-content: center; align-items: center; cursor: pointer; }
        canvas { display: block; max-width: 100vw; max-height: 85vh; }
    </style>
</head>
<body>
    <div class="game-header">
        <h1 style="margin:0; font-size: 18px; color: #ff9900;">Titi Booster Flight ðŸš€</h1>
        <p style="margin:5px 0 0; font-size: 12px;">Appuyez pour faire voler TITI !</p>
    </div>
    <div id="gameContainer"></div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/pixi.js/7.4.3/pixi.min.js"></script>
    
    <script type="module">
        const __ASSET_MAP__ = {
            // ICI ON CHARGE VOTRE IMAGE DE TITI
            "titi_player": { "url": "https://storage.googleapis.com/scraper_ludo/user_images_prod/75818ca0223a6d74cd1d3d4b2794bb6d.png" },
            "sky_background": { "url": "https://storage.googleapis.com/scraper_ludo/user_images_prod/4e8126247acdc48a2cc3d9de1c355c40.png" },
            "instagram_like": { "url": "https://storage.googleapis.com/scraper_ludo/user_images_prod/41561b59787ec16571c3f2bc32279d79.png" },
            "shadowban_cloud": { "url": "https://storage.googleapis.com/scraper_ludo/user_images_prod/a92c4af60a1cdb4229a3676ca00e3746.png" }
        };

        const app = new PIXI.Application({ width: 800, height: 600, backgroundColor: 0x1099bb });
        document.getElementById('gameContainer').appendChild(app.view);

        class Game {
            constructor() {
                this.score = 0;
                this.isGameOver = false;
                this.audioStarted = false;
                this.sndJump = new Audio("https://cdn.pixabay.com/audio/2022/03/24/audio_7302484a00.mp3");
                this.sndCollect = new Audio("https://cdn.pixabay.com/audio/2021/08/04/audio_0625906d9d.mp3");
                this.sndHit = new Audio("https://cdn.pixabay.com/audio/2022/01/18/audio_d0a13f69d2.mp3");
                this.collectibles = [];
                this.obstacles = [];
                this.spawnTimer = 0;
            }

            setup() {
                this.container = new PIXI.Container();
                app.stage.addChild(this.container);

                this.bg = new PIXI.TilingSprite(PIXI.Texture.from(__ASSET_MAP__.sky_background.url), 1600, 600);
                this.container.addChild(this.bg);

                this.player = PIXI.Sprite.from(__ASSET_MAP__.titi_player.url);
                this.player.anchor.set(0.5);
                this.player.x = 150;
                this.player.y = 300;
                this.player.width = 110; // Taille adaptÃ©e pour Titi
                this.player.height = 80;
                this.player.velocity = 0;
                this.container.addChild(this.player);

                this.scoreText = new PIXI.Text('Score: 0', { fill: 0xffffff, fontSize: 30, fontWeight: 'bold' });
                this.scoreText.x = 20; this.scoreText.y = 20;
                app.stage.addChild(this.scoreText);

                app.stage.eventMode = 'static';
                app.stage.on('pointerdown', () => {
                    if (!this.audioStarted) { this.sndJump.play(); this.audioStarted = true; }
                    if(!this.isGameOver) {
                        this.player.velocity = -7;
                        let s = this.sndJump.cloneNode();
                        s.volume = 0.3;
                        s.play();
                    }
                });
            }

            update() {
                if (this.isGameOver) return;
                this.player.velocity += 0.35;
                this.player.y += this.player.velocity;
                this.bg.tilePosition.x -= 3;

                if (this.player.y > 600 || this.player.y < 0) this.gameOver();

                this.spawnTimer++;
                if (this.spawnTimer > 50) {
                    this.createObject();
                    this.spawnTimer = 0;
                }

                this.collectibles.forEach((c, i) => {
                    c.x -= 5;
                    if (this.hitTest(this.player, c)) {
                        this.score += 25;
                        this.sndCollect.play();
                        this.container.removeChild(c);
                        this.collectibles.splice(i, 1);
                    }
                });

                this.obstacles.forEach((o, i) => {
                    o.x -= 6;
                    if (this.hitTest(this.player, o)) {
                        this.sndHit.play();
                        this.gameOver();
                    }
                });

                this.scoreText.text = `Score: ${this.score}`;
                if (this.score >= 1000) this.win();
            }

            createObject() {
                const isObstacle = Math.random() > 0.7;
                const tex = isObstacle ? __ASSET_MAP__.shadowban_cloud.url : __ASSET_MAP__.instagram_like.url;
                const obj = PIXI.Sprite.from(tex);
                obj.anchor.set(0.5);
                obj.x = 850; obj.y = Math.random() * 500 + 50;
                obj.width = 50; obj.height = 50;
                this.container.addChild(obj);
                if(isObstacle) this.obstacles.push(obj);
                else this.collectibles.push(obj);
            }

            hitTest(a, b) {
                const aBox = a.getBounds(); const bBox = b.getBounds();
                return aBox.x + aBox.width > bBox.x && aBox.x < bBox.x + bBox.width && aBox.y + aBox.height > bBox.y && aBox.y < bBox.y + bBox.height;
            }

            gameOver() {
                this.isGameOver = true;
                alert("Game Over! Score: " + this.score);
                location.reload();
            }

            win() {
                this.isGameOver = true;
                alert("FÃ‰LICITATIONS ! Titi a boostÃ© ton compte. Code : TITI-WINS");
                window.location.href = "https://theboostconcept.com";
            }
        }

        const game = new Game();
        PIXI.Assets.load(Object.values(__ASSET_MAP__).map(a => a.url)).then(() => {
            game.setup();
            app.ticker.add(() => game.update());
        });
    </script>
</body>
</html>
