<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Titi Booster Flyer</title>
    <style>
        * { -webkit-tap-highlight-color: transparent; -webkit-touch-callout: none; user-select: none; }
        body { 
            margin: 0; padding: 0; background: #000; overflow: hidden; 
            display: flex; flex-direction: column; min-height: 100vh; 
            font-family: 'Segoe UI', sans-serif; color: white; touch-action: manipulation;
        }
        .game-header { 
            background: rgba(0, 0, 0, 0.95); padding: 8px; text-align: center; 
            z-index: 10; border-bottom: 2px solid #ff9900; 
        }
        .share-container { margin-top: 8px; display: flex; justify-content: center; gap: 10px; }
        .share-btn { padding: 6px 12px; border-radius: 6px; text-decoration: none; color: white; font-size: 12px; font-weight: bold; }
        .fb { background: #1877F2; } .wa { background: #25D366; }
        #gameContainer { flex: 1; display: flex; justify-content: center; align-items: flex-start; padding-top: 5px; position: relative; }
        #boostBarContainer {
            position: absolute; top: 10px; right: 20px; width: 150px; height: 20px;
            border: 2px solid white; border-radius: 10px; overflow: hidden; background: rgba(0,0,0,0.5);
        }
        #boostBar { width: 0%; height: 100%; background: linear-gradient(90deg, #ff9900, #ff0000); transition: width 0.2s; }
        canvas { display: block; max-width: 100vw; max-height: 70vh; }
    </style>
</head>
<body>
    <div class="game-header">
        <h1 style="margin:0; font-size: 18px; color: #ff9900;">Titi Booster Flyer ðŸš€</h1>
        <p style="margin:3px 0; font-size: 13px;">Faites 1000 points et obtenez un bonus de <b>1000F</b> sur <br>
           <a href="https://theboostconcept.com" style="color: #00ff00; text-decoration: none; font-weight: bold;">theboostconcept.com</a>
        </p>
        <p style="margin:2px 0; font-size: 11px; color: #aaa;">Vous pouvez gagner 3 fois !</p>
        <div class="share-container">
            <a href="https://www.facebook.com/sharer/sharer.php?u=https://boostcamer-web.github.io/titi-booster/" target="_blank" class="share-btn fb">Facebook</a>
            <a href="https://api.whatsapp.com/send?text=Joue Ã  Titi Booster Flyer et gagne 1000F de bonus ! ðŸ‘‰ https://boostcamer-web.github.io/titi-booster/" target="_blank" class="share-btn wa">WhatsApp</a>
        </div>
    </div>

    <div id="gameContainer">
        <div id="boostBarContainer"><div id="boostBar"></div></div>
    </div>

    <audio id="bgMusic" loop><source src="https://cdn.pixabay.com/audio/2022/03/15/audio_7302484a00.mp3" type="audio/mpeg"></audio>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/pixi.js/7.4.3/pixi.min.js"></script>
    
    <script type="module">
        const __ASSET_MAP__ = {
            "titi": { "url": "logo1.png" },
            "bg": { "url": "https://storage.googleapis.com/scraper_ludo/user_images_prod/4e8126247acdc48a2cc3d9de1c355c40.png" },
            "insta": { "url": "https://storage.googleapis.com/scraper_ludo/user_images_prod/41561b59787ec16571c3f2bc32279d79.png" },
            "tiktok": { "url": "https://storage.googleapis.com/scraper_ludo/user_images_prod/da26053eade54abfb80d5e9e6b9448a5.png" },
            "robot": { "url": "https://storage.googleapis.com/scraper_ludo/user_images_prod/a92c4af60a1cdb4229a3676ca00e3746.png" }
        };

        const app = new PIXI.Application({ width: 800, height: 600, backgroundColor: 0x1099bb });
        document.getElementById('gameContainer').appendChild(app.view);

        class Game {
            constructor() {
                this.score = 0; this.boost = 0; this.isGameOver = false; this.isBoosting = false;
                this.speed = 4; this.entities = [];
                this.uiBoost = document.getElementById('boostBar');
            }

            setup() {
                this.cont = new PIXI.Container(); app.stage.addChild(this.cont);
                this.sky = new PIXI.TilingSprite(PIXI.Texture.from(__ASSET_MAP__.bg), 1600, 600);
                this.cont.addChild(this.sky);

                this.player = PIXI.Sprite.from(__ASSET_MAP__.titi);
                this.player.anchor.set(0.5); this.player.x = 150; this.player.y = 300;
                this.player.width = 100; this.player.height = 80; this.player.vy = 0;
                this.cont.addChild(this.player);

                this.txt = new PIXI.Text('Score: 0', { fill: 0xffffff, fontSize: 30, fontWeight: 'bold' });
                this.txt.x = 20; this.txt.y = 20; app.stage.addChild(this.txt);

                app.stage.eventMode = 'static';
                app.stage.on('pointerdown', () => {
                    if (!this.music) { document.getElementById('bgMusic').play(); this.music = true; }
                    if (!this.isGameOver) this.player.vy = -8;
                });
            }

            update() {
                if (this.isGameOver) return;

                let gravity = this.isBoosting ? 0.2 : 0.4;
                this.player.vy += gravity;
                this.player.y += this.player.vy;
                this.speed = this.isBoosting ? 10 : 4;
                this.sky.tilePosition.x -= this.speed;

                if (this.player.y > 600 || this.player.y < 0) this.die();

                if (Math.random() < 0.03) this.spawn();

                for (let i = this.entities.length - 1; i >= 0; i--) {
                    let e = this.entities[i];
                    e.x -= this.speed + 2;
                    if (this.hit(this.player, e)) {
                        if (e.isRobot) {
                            if (!this.isBoosting) this.die();
                        } else {
                            this.score += 25; this.boost += 10;
                            this.cont.removeChild(e); this.entities.splice(i, 1);
                        }
                    }
                    if (e.x < -100) { this.cont.removeChild(e); this.entities.splice(i, 1); }
                }

                if (this.boost >= 100) { this.isBoosting = true; this.boost = 100; setTimeout(() => { this.isBoosting = false; this.boost = 0; }, 4000); }
                this.uiBoost.style.width = this.boost + "%";
                this.txt.text = `Score: ${this.score}` + (this.isBoosting ? " - BOOST !!" : "");
                if (this.score >= 1000) this.win();
            }

            spawn() {
                const type = Math.random();
                let tex = type > 0.7 ? __ASSET_MAP__.robot : (type > 0.35 ? __ASSET_MAP__.insta : __ASSET_MAP__.tiktok);
                let s = PIXI.Sprite.from(tex);
                s.anchor.set(0.5); s.x = 850; s.y = Math.random() * 500 + 50;
                s.width = 50; s.height = 50; s.isRobot = (type > 0.7);
                this.entities.push(s); this.cont.addChild(s);
            }

            hit(a, b) {
                const ab = a.getBounds(); const bb = b.getBounds();
                return ab.x + ab.width*0.7 > bb.x && ab.x < bb.x + bb.width*0.7 && ab.y + ab.height*0.7 > bb.y && ab.y < bb.y + bb.height*0.7;
            }

            die() {
                this.isGameOver = true;
                alert("GAME OVER ! \nRessayez pour gagner les 1000F Bonus !");
                location.reload();
            }

            win() {
                this.isGameOver = true;
                alert("FÃ‰LICITATIONS ! Titi a boostÃ© ton compte de 1000F !");
                window.location.href = "https://wa.me/237674142665";
            }
        }

        const g = new Game();
        PIXI.Assets.load(Object.values(__ASSET_MAP__).map(a => a.url)).then(() => {
            g.setup(); app.ticker.add(() => g.update());
        });
    </script>
</body>
</html>
